!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=7)}([function(t){t.exports={a:{name:"Guillaume Martigny",email:"guillaume.martigny@gmail.com",url:"https://www.guillaume-martigny.fr"},b:"https://github.com/pencil-js/pencil.js#readme",c:"1.6.4"}},function(t,e,n){var i=n(2),s=n(6),r={};Object.keys(i).forEach(function(t){r[t]={},Object.defineProperty(r[t],"channels",{value:i[t].channels}),Object.defineProperty(r[t],"labels",{value:i[t].labels});var e=s(t);Object.keys(e).forEach(function(n){var i=e[n];r[t][n]=function(t){var e=function(e){if(null==e)return e;arguments.length>1&&(e=Array.prototype.slice.call(arguments));var n=t(e);if("object"==typeof n)for(var i=n.length,s=0;s<i;s++)n[s]=Math.round(n[s]);return n};return"conversion"in t&&(e.conversion=t.conversion),e}(i),r[t][n].raw=function(t){var e=function(e){return null==e?e:(arguments.length>1&&(e=Array.prototype.slice.call(arguments)),t(e))};return"conversion"in t&&(e.conversion=t.conversion),e}(i)})}),t.exports=r},function(t,e,n){var i=n(5),s={};for(var r in i)i.hasOwnProperty(r)&&(s[i[r]]=r);var o=t.exports={rgb:{channels:3,labels:"rgb"},hsl:{channels:3,labels:"hsl"},hsv:{channels:3,labels:"hsv"},hwb:{channels:3,labels:"hwb"},cmyk:{channels:4,labels:"cmyk"},xyz:{channels:3,labels:"xyz"},lab:{channels:3,labels:"lab"},lch:{channels:3,labels:"lch"},hex:{channels:1,labels:["hex"]},keyword:{channels:1,labels:["keyword"]},ansi16:{channels:1,labels:["ansi16"]},ansi256:{channels:1,labels:["ansi256"]},hcg:{channels:3,labels:["h","c","g"]},apple:{channels:3,labels:["r16","g16","b16"]},gray:{channels:1,labels:["gray"]}};for(var a in o)if(o.hasOwnProperty(a)){if(!("channels"in o[a]))throw new Error("missing channels property: "+a);if(!("labels"in o[a]))throw new Error("missing channel labels property: "+a);if(o[a].labels.length!==o[a].channels)throw new Error("channel and label counts mismatch: "+a);var h=o[a].channels,l=o[a].labels;delete o[a].channels,delete o[a].labels,Object.defineProperty(o[a],"channels",{value:h}),Object.defineProperty(o[a],"labels",{value:l})}o.rgb.hsl=function(t){var e,n,i=t[0]/255,s=t[1]/255,r=t[2]/255,o=Math.min(i,s,r),a=Math.max(i,s,r),h=a-o;return a===o?e=0:i===a?e=(s-r)/h:s===a?e=2+(r-i)/h:r===a&&(e=4+(i-s)/h),(e=Math.min(60*e,360))<0&&(e+=360),n=(o+a)/2,[e,100*(a===o?0:n<=.5?h/(a+o):h/(2-a-o)),100*n]},o.rgb.hsv=function(t){var e,n,i,s,r,o=t[0]/255,a=t[1]/255,h=t[2]/255,l=Math.max(o,a,h),c=l-Math.min(o,a,h),u=function(t){return(l-t)/6/c+.5};return 0===c?s=r=0:(r=c/l,e=u(o),n=u(a),i=u(h),o===l?s=i-n:a===l?s=1/3+e-i:h===l&&(s=2/3+n-e),s<0?s+=1:s>1&&(s-=1)),[360*s,100*r,100*l]},o.rgb.hwb=function(t){var e=t[0],n=t[1],i=t[2];return[o.rgb.hsl(t)[0],100*(1/255*Math.min(e,Math.min(n,i))),100*(i=1-1/255*Math.max(e,Math.max(n,i)))]},o.rgb.cmyk=function(t){var e,n=t[0]/255,i=t[1]/255,s=t[2]/255;return[100*((1-n-(e=Math.min(1-n,1-i,1-s)))/(1-e)||0),100*((1-i-e)/(1-e)||0),100*((1-s-e)/(1-e)||0),100*e]},o.rgb.keyword=function(t){var e=s[t];if(e)return e;var n,r,o,a=1/0;for(var h in i)if(i.hasOwnProperty(h)){var l=i[h],c=(r=t,o=l,Math.pow(r[0]-o[0],2)+Math.pow(r[1]-o[1],2)+Math.pow(r[2]-o[2],2));c<a&&(a=c,n=h)}return n},o.keyword.rgb=function(t){return i[t]},o.rgb.xyz=function(t){var e=t[0]/255,n=t[1]/255,i=t[2]/255;return[100*(.4124*(e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92)+.3576*(n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92)+.1805*(i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92)),100*(.2126*e+.7152*n+.0722*i),100*(.0193*e+.1192*n+.9505*i)]},o.rgb.lab=function(t){var e=o.rgb.xyz(t),n=e[0],i=e[1],s=e[2];return i/=100,s/=108.883,n=(n/=95.047)>.008856?Math.pow(n,1/3):7.787*n+16/116,[116*(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116)-16,500*(n-i),200*(i-(s=s>.008856?Math.pow(s,1/3):7.787*s+16/116))]},o.hsl.rgb=function(t){var e,n,i,s,r,o=t[0]/360,a=t[1]/100,h=t[2]/100;if(0===a)return[r=255*h,r,r];e=2*h-(n=h<.5?h*(1+a):h+a-h*a),s=[0,0,0];for(var l=0;l<3;l++)(i=o+1/3*-(l-1))<0&&i++,i>1&&i--,r=6*i<1?e+6*(n-e)*i:2*i<1?n:3*i<2?e+(n-e)*(2/3-i)*6:e,s[l]=255*r;return s},o.hsl.hsv=function(t){var e=t[0],n=t[1]/100,i=t[2]/100,s=n,r=Math.max(i,.01);return n*=(i*=2)<=1?i:2-i,s*=r<=1?r:2-r,[e,100*(0===i?2*s/(r+s):2*n/(i+n)),100*((i+n)/2)]},o.hsv.rgb=function(t){var e=t[0]/60,n=t[1]/100,i=t[2]/100,s=Math.floor(e)%6,r=e-Math.floor(e),o=255*i*(1-n),a=255*i*(1-n*r),h=255*i*(1-n*(1-r));switch(i*=255,s){case 0:return[i,h,o];case 1:return[a,i,o];case 2:return[o,i,h];case 3:return[o,a,i];case 4:return[h,o,i];case 5:return[i,o,a]}},o.hsv.hsl=function(t){var e,n,i,s=t[0],r=t[1]/100,o=t[2]/100,a=Math.max(o,.01);return i=(2-r)*o,n=r*a,[s,100*(n=(n/=(e=(2-r)*a)<=1?e:2-e)||0),100*(i/=2)]},o.hwb.rgb=function(t){var e,n,i,s,r,o,a,h=t[0]/360,l=t[1]/100,c=t[2]/100,u=l+c;switch(u>1&&(l/=u,c/=u),i=6*h-(e=Math.floor(6*h)),0!=(1&e)&&(i=1-i),s=l+i*((n=1-c)-l),e){default:case 6:case 0:r=n,o=s,a=l;break;case 1:r=s,o=n,a=l;break;case 2:r=l,o=n,a=s;break;case 3:r=l,o=s,a=n;break;case 4:r=s,o=l,a=n;break;case 5:r=n,o=l,a=s}return[255*r,255*o,255*a]},o.cmyk.rgb=function(t){var e=t[0]/100,n=t[1]/100,i=t[2]/100,s=t[3]/100;return[255*(1-Math.min(1,e*(1-s)+s)),255*(1-Math.min(1,n*(1-s)+s)),255*(1-Math.min(1,i*(1-s)+s))]},o.xyz.rgb=function(t){var e,n,i,s=t[0]/100,r=t[1]/100,o=t[2]/100;return n=-.9689*s+1.8758*r+.0415*o,i=.0557*s+-.204*r+1.057*o,e=(e=3.2406*s+-1.5372*r+-.4986*o)>.0031308?1.055*Math.pow(e,1/2.4)-.055:12.92*e,n=n>.0031308?1.055*Math.pow(n,1/2.4)-.055:12.92*n,i=i>.0031308?1.055*Math.pow(i,1/2.4)-.055:12.92*i,[255*(e=Math.min(Math.max(0,e),1)),255*(n=Math.min(Math.max(0,n),1)),255*(i=Math.min(Math.max(0,i),1))]},o.xyz.lab=function(t){var e=t[0],n=t[1],i=t[2];return n/=100,i/=108.883,e=(e/=95.047)>.008856?Math.pow(e,1/3):7.787*e+16/116,[116*(n=n>.008856?Math.pow(n,1/3):7.787*n+16/116)-16,500*(e-n),200*(n-(i=i>.008856?Math.pow(i,1/3):7.787*i+16/116))]},o.lab.xyz=function(t){var e,n,i,s=t[0];e=t[1]/500+(n=(s+16)/116),i=n-t[2]/200;var r=Math.pow(n,3),o=Math.pow(e,3),a=Math.pow(i,3);return n=r>.008856?r:(n-16/116)/7.787,e=o>.008856?o:(e-16/116)/7.787,i=a>.008856?a:(i-16/116)/7.787,[e*=95.047,n*=100,i*=108.883]},o.lab.lch=function(t){var e,n=t[0],i=t[1],s=t[2];return(e=360*Math.atan2(s,i)/2/Math.PI)<0&&(e+=360),[n,Math.sqrt(i*i+s*s),e]},o.lch.lab=function(t){var e,n=t[0],i=t[1];return e=t[2]/360*2*Math.PI,[n,i*Math.cos(e),i*Math.sin(e)]},o.rgb.ansi16=function(t){var e=t[0],n=t[1],i=t[2],s=1 in arguments?arguments[1]:o.rgb.hsv(t)[2];if(0===(s=Math.round(s/50)))return 30;var r=30+(Math.round(i/255)<<2|Math.round(n/255)<<1|Math.round(e/255));return 2===s&&(r+=60),r},o.hsv.ansi16=function(t){return o.rgb.ansi16(o.hsv.rgb(t),t[2])},o.rgb.ansi256=function(t){var e=t[0],n=t[1],i=t[2];return e===n&&n===i?e<8?16:e>248?231:Math.round((e-8)/247*24)+232:16+36*Math.round(e/255*5)+6*Math.round(n/255*5)+Math.round(i/255*5)},o.ansi16.rgb=function(t){var e=t%10;if(0===e||7===e)return t>50&&(e+=3.5),[e=e/10.5*255,e,e];var n=.5*(1+~~(t>50));return[(1&e)*n*255,(e>>1&1)*n*255,(e>>2&1)*n*255]},o.ansi256.rgb=function(t){if(t>=232){var e=10*(t-232)+8;return[e,e,e]}var n;return t-=16,[Math.floor(t/36)/5*255,Math.floor((n=t%36)/6)/5*255,n%6/5*255]},o.rgb.hex=function(t){var e=(((255&Math.round(t[0]))<<16)+((255&Math.round(t[1]))<<8)+(255&Math.round(t[2]))).toString(16).toUpperCase();return"000000".substring(e.length)+e},o.hex.rgb=function(t){var e=t.toString(16).match(/[a-f0-9]{6}|[a-f0-9]{3}/i);if(!e)return[0,0,0];var n=e[0];3===e[0].length&&(n=n.split("").map(function(t){return t+t}).join(""));var i=parseInt(n,16);return[i>>16&255,i>>8&255,255&i]},o.rgb.hcg=function(t){var e,n=t[0]/255,i=t[1]/255,s=t[2]/255,r=Math.max(Math.max(n,i),s),o=Math.min(Math.min(n,i),s),a=r-o;return e=a<=0?0:r===n?(i-s)/a%6:r===i?2+(s-n)/a:4+(n-i)/a+4,e/=6,[360*(e%=1),100*a,100*(a<1?o/(1-a):0)]},o.hsl.hcg=function(t){var e=t[1]/100,n=t[2]/100,i=1,s=0;return(i=n<.5?2*e*n:2*e*(1-n))<1&&(s=(n-.5*i)/(1-i)),[t[0],100*i,100*s]},o.hsv.hcg=function(t){var e=t[1]/100,n=t[2]/100,i=e*n,s=0;return i<1&&(s=(n-i)/(1-i)),[t[0],100*i,100*s]},o.hcg.rgb=function(t){var e=t[0]/360,n=t[1]/100,i=t[2]/100;if(0===n)return[255*i,255*i,255*i];var s,r=[0,0,0],o=e%1*6,a=o%1,h=1-a;switch(Math.floor(o)){case 0:r[0]=1,r[1]=a,r[2]=0;break;case 1:r[0]=h,r[1]=1,r[2]=0;break;case 2:r[0]=0,r[1]=1,r[2]=a;break;case 3:r[0]=0,r[1]=h,r[2]=1;break;case 4:r[0]=a,r[1]=0,r[2]=1;break;default:r[0]=1,r[1]=0,r[2]=h}return s=(1-n)*i,[255*(n*r[0]+s),255*(n*r[1]+s),255*(n*r[2]+s)]},o.hcg.hsv=function(t){var e=t[1]/100,n=e+t[2]/100*(1-e),i=0;return n>0&&(i=e/n),[t[0],100*i,100*n]},o.hcg.hsl=function(t){var e=t[1]/100,n=t[2]/100*(1-e)+.5*e,i=0;return n>0&&n<.5?i=e/(2*n):n>=.5&&n<1&&(i=e/(2*(1-n))),[t[0],100*i,100*n]},o.hcg.hwb=function(t){var e=t[1]/100,n=e+t[2]/100*(1-e);return[t[0],100*(n-e),100*(1-n)]},o.hwb.hcg=function(t){var e=t[1]/100,n=1-t[2]/100,i=n-e,s=0;return i<1&&(s=(n-i)/(1-i)),[t[0],100*i,100*s]},o.apple.rgb=function(t){return[t[0]/65535*255,t[1]/65535*255,t[2]/65535*255]},o.rgb.apple=function(t){return[t[0]/255*65535,t[1]/255*65535,t[2]/255*65535]},o.gray.rgb=function(t){return[t[0]/100*255,t[0]/100*255,t[0]/100*255]},o.gray.hsl=o.gray.hsv=function(t){return[0,0,t[0]]},o.gray.hwb=function(t){return[0,100,t[0]]},o.gray.cmyk=function(t){return[0,0,0,t[0]]},o.gray.lab=function(t){return[t[0],0,0]},o.gray.hex=function(t){var e=255&Math.round(t[0]/100*255),n=((e<<16)+(e<<8)+e).toString(16).toUpperCase();return"000000".substring(n.length)+n},o.rgb.gray=function(t){return[(t[0]+t[1]+t[2])/3/255*100]}},function(t,e,n){"use strict";const i=t=>{let e=2166136261;for(let n=0;n<t.length;n++)e^=t.charCodeAt(n),e+=(e<<1)+(e<<4)+(e<<7)+(e<<8)+(e<<24);return e>>>0};t.exports=i,t.exports.default=i},function(t,e,n){!function(t){"use strict";function e(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function n(t){for(var n=1;n<arguments.length;n++)if(n%2){var i=null!=arguments[n]?arguments[n]:{},s=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(s=s.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),s.forEach(function(n){e(t,n,i[n])})}else Object.defineProperties(t,Object.getOwnPropertyDescriptors(arguments[n]));return t}const i=["—"],s=["­"],r=[" "," "," "," "," "," "," "," "," "," "," "," "," ","　","\t","​","\u2028","\u2029"],o=["֊","‐","‒","–","־","་","፡","៘","៚","‧","|","᛫","᛬","᛭","⁖","⁘","⁙","⁚","⁛","⁝","⁞","⸙","⸪","⸫","⸬","⸭","⸰","တ0","တ1","တ2","္F","ွ0","႑F","ቇ0"],a=["´","´"],h=["\n"],l={"font-size":"16px","font-weight":"400","font-family":"Helvetica, Arial, sans-serif"};function c(t,e){e||(e={});const n=parseInt(x(e,"base-font-size",16),10),i=parseFloat(t),s=t.replace(i,"");switch(s){case"rem":case"em":return i*n;case"pt":return i/(96/72);case"px":return i}throw new Error("The unit "+s+" is not supported")}function u(t,e){const n=["inherit","initial","unset","normal"];let i=0;t&&-1===n.indexOf(t)&&(i=c(t));let s=0;return e&&-1===n.indexOf(e)&&(s=c(e)),t=>{const e=t.trim().replace(/\s+/gi," ").split(" ").length-1,n=t.length;return e*i+n*s}}function d(t,e){const n=[],i=x(e,"font-weight",t.getPropertyValue("font-weight"))||l["font-weight"];-1!==["normal","bold","bolder","lighter","100","200","300","400","500","600","700","800","900"].indexOf(i.toString())&&n.push(i);const s=x(e,"font-style",t.getPropertyValue("font-style"));-1!==["normal","italic","oblique"].indexOf(s)&&n.push(s);const r=x(e,"font-variant",t.getPropertyValue("font-variant"));-1!==["normal","small-caps"].indexOf(r)&&n.push(r);const o=x(e,"font-size",t.getPropertyValue("font-size"))||l["font-size"],a=c(o);n.push(a+"px");const h=x(e,"font-family",t.getPropertyValue("font-family"))||l["font-family"];return n.push(h),n.join(" ")}function p(t){return t&&"function"==typeof t.getPropertyValue}function f(t){return g(t)&&t.style&&"undefined"!=typeof window&&"function"==typeof window.getComputedStyle}function g(t){return"object"==typeof HTMLElement?t instanceof HTMLElement:Boolean(t&&"object"==typeof t&&null!==t&&1===t.nodeType&&"string"==typeof t.nodeName)}function w(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function m(t,e){const i=n({},e||{}),{style:s}=i;return e||(e={}),p(s)?s:f(t)?window.getComputedStyle(t,x(e,"pseudoElt",null)):{getPropertyValue:t=>x(e,t)}}function y(t,e){switch(e.getPropertyValue("text-transform")){case"uppercase":return t.toUpperCase();case"lowercase":return t.toLowerCase();default:return t}}function v(t){return t=(t||"").replace(/<wbr>/gi,"​").replace(/<br\s*\/?>/gi,"\n").replace(/&shy;/gi,"­").replace(/&mdash;/gi,"—"),/&#(\d+)(;?)|&#[xX]([a-fA-F0-9]+)(;?)|&([0-9a-zA-Z]+);/g.test(t)&&console&&console.error("text-metrics: Found encoded htmlenties. You may want to use https://mths.be/he to decode your text first."),t.trim()}function b(t){if(!t)return"";const e=t.innerText||t.textContent||"";return e.trim()}function x(t,e,n){return t&&void 0!==t[e]&&t[e]||n}function k(t){const e={};return Object.keys(t||{}).forEach(n=>{const i=n.replace(/([A-Z])/g,t=>"-"+t.toLowerCase());e[i]=t[n]}),e}function O(t){try{const e=document.createElement("canvas").getContext("2d"),n=window.devicePixelRatio||1,i=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return e.font=t,e.setTransform(n/i,0,0,n/i,0,0),e}catch(t){throw new Error("Canvas support required")}}function S(t){return(i.includes(t)?"B2":r.includes(t)&&"BAI")||s.includes(t)&&"SHY"||o.includes(t)&&"BA"||a.includes(t)&&"BB"||h.includes(t)&&"BK"}function M({ctx:t,text:e,max:n,wordSpacing:i,letterSpacing:s}){const o=u(i,s),a=[],h=[],l=[];let c="",d="";if(!e)return[];for(const t of e){const e=S(t);""===d&&"BAI"===e||(e?(l.push({chr:t,type:e}),h.push(d),d=""):d+=t)}d&&h.push(d);for(let e=0;e<h.length;e++){if(0===e){c=h[e];continue}const i=h[e];if(r.includes(h[e-1])&&r.includes(h[e]))continue;const s=l[e-1],u="SHY"===s.type?"":s.chr;if("BK"===s.type){a.push(c),c=i;continue}const d=t.measureText(c+u+i).width+o(c+u+i),p=Math.round(d,10);if(p<=n)c+=u+i;else switch(s.type){case"SHY":a.push(c+"-"),c=i;break;case"BA":a.push(c+u),c=i;break;case"BAI":a.push(c),c=i;break;case"BB":a.push(c),c=u+i;break;case"B2":parseInt(t.measureText(c+u).width+o(c+u),10)<=n?(a.push(c+u),c=i):parseInt(t.measureText(u+i).width+o(u+i),10)<=n?(a.push(c),c=u+i):(a.push(c),a.push(u),c=i);break;default:throw new Error("Undefoined break")}}return 0!==[...c].length&&a.push(c),a}function z({ctx:t,text:e,max:n,wordSpacing:i,letterSpacing:s}){const o=u(i,s),a=[];let h="",l=0;if(!e)return[];for(const i of e){const s=S(i);if("BK"===s){a.push(h),h="";continue}const c=h.length;if(r.includes(i)&&(0===c||r.includes(h[c-1])))continue;let u=t.measureText(h+i).width+o(h+i),d=Math.ceil(u);if("SHY"===s){const n=e[l+1]||"";u=t.measureText(h+i+n).width+o(h+i+n),d=Math.ceil(u)}if(d>n&&0!==[...h].length)switch(s){case"SHY":a.push(h+"-"),h="";break;case"BA":a.push(h+i),h="";break;case"BAI":a.push(h),h="";break;default:a.push(h),h=i}else"­"!==i&&(h+=i);l++}return 0!==[...h].length&&a.push(h),a}class R{constructor(t,e={}){!g(t)&&w(t)?(this.el=void 0,this.overwrites=k(t)):(this.el=t,this.overwrites=k(e)),this.style=m(this.el,this.overwrites),this.font=x(e,"font",null)||d(this.style,this.overwrites)}padding(){return this.el?parseInt(this.style.paddingLeft||0,10)+parseInt(this.style.paddingRight||0,10):0}width(t,e={},i={}){if("object"==typeof t&&t&&(i=e,e=t||{},t=void 0),!(t=!t&&this.el?this.el.textContent.trim():v(t)))return 0;const s=y(t,this.style),r=n({},this.overwrites,k(i)),o=d(this.style,r),a=x(r,"letter-spacing")||this.style.getPropertyValue("letter-spacing"),h=x(r,"word-spacing")||this.style.getPropertyValue("word-spacing"),l=u(h,a),c=O(o);return e.multiline?this.lines(s,e,i).reduce((t,e)=>{const n=c.measureText(e).width+l(e);return Math.max(t,n)},0):c.measureText(s).width+l(s)}height(t,e,i){"object"==typeof t&&t&&(i=e,e=t||{},t=void 0),e||(e={}),i||(e={}),t=!t&&this.el?b(this.el):v(t);const s=n({},this.overwrites,k(i)),r=parseFloat(x(s,"line-height")||this.style.getPropertyValue("line-height"));return Math.ceil(this.lines(t,e,s).length*r||0)}lines(t,e,i){"object"==typeof t&&t&&(i=e,e=t,t=void 0),void 0===i&&(i=e),e||(e={}),i||(e={}),t=!t&&this.el?b(this.el):v(t);const s=n({},this.overwrites,k(i)),r=d(this.style,s);let o=parseInt(x(e,"width")||x(i,"width"),10)||x(this.el,"offsetWidth",0)||parseInt(x(s,"width",0),10)||parseInt(this.style.width,10);o-=this.padding();const a=x(s,"word-break")||this.style.getPropertyValue("word-break"),h=x(s,"letter-spacing")||this.style.getPropertyValue("letter-spacing"),l=x(s,"word-spacing")||this.style.getPropertyValue("word-spacing"),c=O(r);return t=y(t,this.style),"break-all"===a?z({ctx:c,text:t,max:o,wordSpacing:l,letterSpacing:h}):M({ctx:c,text:t,max:o,wordSpacing:l,letterSpacing:h})}maxFontSize(t,e,i){"object"==typeof t&&t&&(i=e,e=t,t=void 0),void 0===i&&(i=e),e||(e={}),i||(e={}),t=!t&&this.el?b(this.el):v(t);const s=n({},this.overwrites,k(i)),r=i=>Math.ceil(this.width(t,e,n({},s,{"font-size":i+"px"})));let o=parseInt(x(e,"width")||x(i,"width"),10)||x(this.el,"offsetWidth",0)||parseInt(x(s,"width",0),10)||parseInt(this.style.width,10);o-=this.padding();let a=Math.floor(o/2),h=r(a);if(a=Math.floor(a/h*o),h=r(a),Math.ceil(h)===o)return a?a+"px":void 0;const l=h>o&&a>0;for(;h>o&&a>0;)h=r(a-=1);if(!l)for(;h<o;){if((h=r(a+1))>o)return a?a+"px":void 0;a+=1}return a?a+"px":void 0}}const E=n({},Object.freeze({addWordAndLetterSpacing:u,getFont:d,isCSSStyleDeclaration:p,canGetComputedStyle:f,isElement:g,isObject:w,getStyle:m,getStyledText:y,prepareText:v,getText:b,prop:x,normalizeOptions:k,getContext2d:O,computeLinesDefault:M,computeLinesBreakAll:z}));t.init=((t,e)=>new R(t,e)),t.utils=E,Object.defineProperty(t,"__esModule",{value:!0})}(e)},function(t,e,n){"use strict";t.exports={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},function(t,e,n){var i=n(2);function s(t){var e=function(){for(var t={},e=Object.keys(i),n=e.length,s=0;s<n;s++)t[e[s]]={distance:-1,parent:null};return t}(),n=[t];for(e[t].distance=0;n.length;)for(var s=n.pop(),r=Object.keys(i[s]),o=r.length,a=0;a<o;a++){var h=r[a],l=e[h];-1===l.distance&&(l.distance=e[s].distance+1,l.parent=s,n.unshift(h))}return e}function r(t,e){return function(n){return e(t(n))}}function o(t,e){for(var n=[e[t].parent,t],s=i[e[t].parent][t],o=e[t].parent;e[o].parent;)n.unshift(e[o].parent),s=r(i[e[o].parent][o],s),o=e[o].parent;return s.conversion=n,s}t.exports=function(t){for(var e=s(t),n={},i=Object.keys(e),r=i.length,a=0;a<r;a++){var h=i[a];null!==e[h].parent&&(n[h]=o(h,e))}return n}},function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"constrain",function(){return o}),n.d(i,"equals",function(){return a}),n.d(i,"random",function(){return h}),n.d(i,"truncate",function(){return l}),n.d(i,"radianCircle",function(){return c}),n.d(i,"degreeCircle",function(){return u}),n.d(i,"phi",function(){return d}),n.d(i,"modulo",function(){return p}),n.d(i,"distribute",function(){return f}),n.d(i,"sum",function(){return g}),n.d(i,"average",function(){return w}),n.d(i,"map",function(){return m});class s{constructor(){this.eventListeners={}}on(t,e,n=!1){const i={callback:e,element:this,isTargeted:n};return(Array.isArray(t)?t:[t]).forEach(t=>{this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(i)}),this}fire(t){const e=this.eventListeners[t.name];return e&&e.length&&e.forEach(e=>{e.isTargeted&&e.element!==t.target||e.callback.call(this,t)}),this}static get events(){return{}}}class r{constructor(t,e){this.name=t,this.target=e}}const o=(t,e,n)=>Math.min(Math.max(t,e),n),a=(t,e,n=Number.EPSILON)=>Math.abs(t-e)<n,h=(t=1,e)=>{let n=t,i=e;return void 0===e&&(n=0,i=t),Math.random()*(i-n)+n},l=t=>t<<0,c=2*Math.PI,u=360,d=(Math.sqrt(5)+1)/2,p=(t,e)=>{const n=t%e;return Math.sign(t)===Math.sign(e)?n:n+e},f=(t,e=0,n=1)=>{const i=h(e,n),s=n-e;return[...new Array(t)].map((t,n)=>e+p(i+n*d*s,s))},g=(...t)=>t.reduce((t,e)=>t+e,0),w=(...t)=>g(...t)/t.length,m=(t,e,n,i=0,s=1)=>(t-e)/(n-e)*(s-i)+i;class y{constructor(t=0,e=0){this.x=+t,this.y=+e}set(t,e){let n=0,i=0;if("number"==typeof t)n=t,i=void 0===e?t:e;else{const e=y.from(t);({x:n,y:i}=e)}return this.x=n,this.y=i,this}clone(){return new y(this.x,this.y)}equals(t){const e=y.from(t);return a(this.x,e.x)&&a(this.y,e.y)}calc(t,e,n){let i=0,s=0;if("number"==typeof e)i=t(this.x,e),s=t(this.y,void 0===n?e:n);else{const n=y.from(e);i=t(this.x,n.x),s=t(this.y,n.y)}return this.set(i,s)}add(t,e){return this.calc((t,e)=>t+e,t,e)}subtract(t,e){return this.calc((t,e)=>t-e,t,e)}multiply(t,e){return this.calc((t,e)=>t*e,t,e)}divide(t,e){return this.calc((t,e)=>t/e,t,e)}modulo(t,e){return this.calc((t,e)=>p(t,e),t,e)}power(t,e){return this.calc((t,e)=>t**e,t,e)}rotate(t=0,e){const{cos:n,sin:i}=Math,s=t*c,r=y.from(e),o=this.clone().subtract(r),a=o.x*n(s)-o.y*i(s),h=o.y*n(s)+o.x*i(s);return this.set(a,h).add(r)}constrain(t,e){const n=y.from(t),i=y.from(e),s=o(this.x,n.x,i.x),r=o(this.y,n.y,i.y);return this.set(s,r)}lerp(t,e){const n=y.from(t).clone().subtract(this).multiply("function"==typeof e?e():e);return this.add(n)}distance(t){const e=y.from(t);return Math.hypot(e.x-this.x,e.y-this.y)}crossProduct(t){const e=y.from(t);return this.x*e.y-e.x*this.y}isOnSameSide(t,e){const n=y.from(t),i=this.clone().subtract(e.start),s=n.clone().subtract(e.start),r=e.getDelta(),{sign:o}=Math;return o(i.crossProduct(r))===o(s.crossProduct(r))}toJSON(){const{x:t,y:e}=this;return[l(t),l(e)]}static from(t=new y){if(t instanceof y)return t;if(Array.isArray(t))return new y(...t);if("Object"===t.constructor.name)return new y(t.x,t.y);throw new TypeError(`Unexpected type for position: ${JSON.stringify(t)}.`)}static average(...t){let e=new y;t.forEach(t=>e=e.add(y.from(t)));const n=t.length;return e.divide(n)}}class v{constructor(t=1,e=1){this.ctx=window.document.createElement("canvas").getContext("2d"),this.width=t,this.height=e}get width(){return this.ctx.canvas.width}set width(t){this.ctx.canvas.width=+t}get height(){return this.ctx.canvas.height}set height(t){this.ctx.canvas.height=+t}render(t){return this.clear(),t.render(this.ctx),this}clear(){return this.ctx.clearRect(0,0,this.width,this.height),this}set imageData(t){this.ctx.putImageData(t,0,0)}get imageData(){return this.ctx.getImageData(0,0,this.width,this.height)}toImage(t="image/png"){const e=window.document.createElement("img");return e.width=this.width,e.height=this.height,e.src=this.ctx.canvas.toDataURL(t),e}}function b(t){let e;try{e=x.from(t).getDelta()}catch(n){e=t.getDelta?t.getDelta():t}return e}class x{constructor(t,e){this.start=y.from(t),this.end=y.from(e)}get width(){return Math.abs(this.start.x-this.end.x)}get height(){return Math.abs(this.start.y-this.end.y)}get length(){return this.start.distance(this.end)}clone(){return new x(this.start.clone(),this.end.clone())}equals(t){const e=x.from(t);return this.start.equals(e.start)&&this.end.equals(e.end)}getDelta(){return this.end.clone().subtract(this.start)}add(t){const e=b(t);return this.end.add(e),this}translate(t){const e=b(t);return this.start.add(e),this.end.add(e),this}multiply(t){if("number"==typeof t)return this.add(this.getDelta().multiply(t-1)),this;const e=b(t);return this.end.multiply(e),this}intersect(t){const e=x.from(t);return!(this.start.isOnSameSide(this.end,e)||e.start.isOnSameSide(e.end,this))}toJSON(){const{start:t,end:e}=this;return[t,e]}static from(t=new x){if(t instanceof x)return t;if(Array.isArray(t)&&2===t.length&&(Array.isArray(t[0])&&Array.isArray(t[1])||t[0]instanceof y&&t[1]instanceof y))return new x(...t);if("Object"===t.constructor.name)return new x(t.start,t.end);throw new TypeError(`Unexpected type for vector [${typeof t}]`)}}const k=Symbol("_scenePromise");class O extends s{constructor(t=new y,e){super(),this.position=y.from(t),this.options={...this.constructor.defaultOptions,...e},this.options.rotationCenter=y.from(this.options.rotationCenter),this.children=[],this.parent=null,this.frameCount=0,this[k]=new Promise(t=>{this.on(O.events.attach,()=>{const e=this.getRoot();e.isScene?t(e):e.getScene().then(e=>t(e))})})}isHover(){return!1}add(...t){return t.forEach(t=>{if(t===this)throw new RangeError("A container can't contain itself.");if(t.isScene)throw new RangeError("A scene can't be contained in another container.");t.parent&&t.parent.remove(t),t.parent=this,this.children.push(t),t.fire(new r(O.events.attach,t))}),this}remove(...t){return t.forEach(t=>{if(this.children.includes(t)){const e=this.children.splice(this.children.indexOf(t),1)[0];e.parent=null,e.fire(new r(O.events.detach,e))}}),this}empty(){return this.remove(...this.children)}delete(){return this.parent&&this.parent.remove(this),this}getScene(){return this[k]}getRoot(){return this.parent?this.parent.getRoot():this}getAbsolutePosition(){const t=new y;return this.climbAncestry(e=>{t.rotate(e.options.rotation,e.options.rotationCenter).add(e.position)}),t}fire(t){return super.fire(t),this.parent&&this.parent.fire(t),this}getTarget(t,e){if(!this.options.shown)return null;const n=t.clone().subtract(this.position).rotate(-this.options.rotation,this.options.rotationCenter);let i=null,s=this.children.length-1;for(;!i&&s>=0;)i=this.children[s].getTarget(n,e),--s;return i?i.options.zIndex<0&&this===i.parent&&this.isHover(t,e)&&this||i:this.isHover(t,e)&&this||null}render(t){if(!this.options.shown)return this;if(this.frameCount++,this.fire(new r(O.events.draw,this)),t.save(),t.translate(this.position.x,this.position.y),this.options.clip){const e=new window.Path2D,n=this.options.clip===O.ITSELF?this:this.options.clip,{x:i,y:s}=n.position;t.translate(i,s),n.trace&&n.trace(e),t.clip(e),t.translate(-i,-s)}if(this.options.rotation){const e=y.from(this.options.rotationCenter);t.translate(e.x,e.y),t.rotate(this.options.rotation*c),t.translate(-e.x,-e.y)}this.children.sort((t,e)=>t.options.zIndex-e.options.zIndex),null!==this.options.opacity&&t.globalAlpha!==this.options.opacity&&(t.globalAlpha=this.options.opacity);const e=this.children.filter(t=>t.options.zIndex<0).length;for(let n=0,i=e;n<i;++n)this.children[n].render(t);this.makePath(t);for(let n=e,i=this.children.length;n<i;++n)this.children[n].render(t);return t.restore(),this}makePath(){return this}show(){return this.options.shown=!0,this}hide(){return this.options.shown=!1,this}isAncestorOf(t){return!(!t||!t.parent)&&(t.parent===this||this.isAncestorOf(t.parent))}climbAncestry(t,e){t(this),this.parent&&this.parent!==e&&this.parent.climbAncestry(t)}getTaintedCanvas(t){let e;if(t?e=x.from(t):this.width&&this.height&&(e=new x(new y,[this.width,this.height])),e){const t=e.getDelta(),n=new v(t.x,t.y);return n.ctx.translate(-this.position.x,-this.position.y),this.render(n.ctx),n}return null}toImage(t){const e=this.getTaintedCanvas(t);return e?e.toImage():null}toJSON(){const{defaultOptions:t}=this.constructor,e={};Object.keys(this.options).forEach(n=>{const i=this.options[n];(i&&i.equals?i.equals(t[n]):Object.is(i,t[n]))||(e[n]=i)});const n={constructor:this.constructor.name,position:this.position};return this.children.length&&(n.children=this.children.map(t=>t.toJSON())),Object.keys(e).length&&(n.options=e),n}clone(){return this.constructor.from(this.toJSON())}static from(t){return new O(t.position,t.options)}static get defaultOptions(){return{shown:!0,opacity:null,rotation:0,rotationCenter:new y,zIndex:1,clip:null}}static get events(){return{...super.events,attach:"attach",detach:"detach",draw:"draw"}}static get ITSELF(){return"itself"}}class S extends O{constructor(t,e={}){super(t,e),this.options.shadow={...S.defaultOptions.shadow,...e.shadow},this.options.shadow.position=y.from(this.options.shadow.position),this.isClicked=!1,this.isHovered=!1}getOrigin(){return y.from(this.options.origin)}makePath(t){t.save();const[e,n]=this.setContext(t);if(e||n){const i=new window.Path2D;this.trace(i),e&&t.fill(i),n&&t.stroke(i),t.restore()}return this}setContext(t){const e=this.options.fill,n=this.options.stroke&&this.options.strokeWidth>0;if(e||n){const i=this.getOrigin();t.translate(i.x,i.y),this.options.shadow.color&&(t.shadowColor=this.options.shadow.color.toString(),t.shadowBlur=this.options.shadow.blur,t.shadowOffsetX=this.options.shadow.position.x,t.shadowOffsetY=this.options.shadow.position.y),e&&(t.fillStyle=this.options.fill.toString(t)),n&&(t.lineJoin=this.options.join,t.lineCap=this.options.cap,t.strokeStyle=this.options.stroke.toString(t),t.lineWidth=this.options.strokeWidth)}return[e,n]}trace(){throw new ReferenceError(`Unimplemented trace function in ${this.constructor.name}`)}isHover(t,e=(new v).ctx){if(!this.options.shown)return!1;const n=this.getOrigin(),i=y.from(t).clone().subtract(this.position),s=i.clone().rotate(-this.options.rotation,this.options.rotationCenter).subtract(n),r=new window.Path2D;this.trace(r);let o=this.options.fill&&e.isPointInPath(r,s.x,s.y)||this.options.stroke&&this.options.strokeWidth>0&&e.isPointInStroke(r,s.x,s.y);if(this.options.clip){const t=this.options.clip===O.ITSELF?this:this.options.clip;o=o&&t.isHover(i,e)}return o}static get defaultOptions(){return{...super.defaultOptions,fill:"#000",stroke:null,strokeWidth:2,cursor:S.cursors.default,join:S.joins.miter,origin:new y,shadow:{blur:0,position:new y,color:null}}}static get cursors(){const t={default:"default",none:"none",contextMenu:"context-menu",help:"help",pointer:"pointer",progress:"progress",wait:"wait",cell:"cell",crosshair:"crosshair",text:"text",textVertical:"vertical-text",alias:"alias",copy:"copy",move:"move",noDrop:"no-drop",notAllowed:"not-allowed",grab:"grab",grabbing:"grabbing",allScroll:"all-scroll",colResize:"col-resize",rowResize:"row-resize",nResize:"n-resize",eResize:"e-resize",sResize:"s-resize",wResize:"w-resize",neResize:"ne-resize",seResize:"se-resize",swResize:"sw-resize",nwResize:"nw-resize",ewResize:"ew-resize",nsResize:"ns-resize",neswResize:"nesw-resize",nwseResize:"nwse-resize",zoomIn:"zoom-in",zoomOut:"zoom-out"};return t.link=t.alias,t.verticalResize=t.rowResize,t.horizontalResize=t.colResize,t.topResize=t.nResize,t.rightResize=t.eResize,t.bottomResize=t.sResize,t.leftResize=t.wResize,t}static get joins(){return{miter:"miter",round:"round",bevel:"bevel"}}}class M extends r{constructor(t,e,n){super(t,e),this.key=n}static get events(){return{down:"keydown",up:"keyup"}}static get keys(){return{backspace:"Backspace",enter:"Enter",delete:"Delete",escape:"Escape",control:"Control",shift:"Shift",arrows:{up:"ArrowUp",right:"ArrowRight",down:"ArrowDown",left:"ArrowLeft"},tab:"Tab",alt:"Alt",altGr:"AltGraph",pageUp:"PageUp",pageDown:"PageDown",start:"Home",end:"End",insert:"Insert"}}}class z extends r{constructor(t,e,n){super(t,e),this.position=y.from(n)}static get events(){return{down:"mousedown",up:"mouseup",click:"click",move:"mousemove",hover:"hover",leave:"leave",wheel:"mousewheel",scrollDown:"scrolldown",scrollUp:"scrollup",zoomOut:"zoomout",zoomIn:"zoomin",grab:"grab",drag:"drag",drop:"drop",resize:"resize"}}}const R=Symbol("_listenForEvents");class E extends O{constructor(t=window.document.body,e){super(void 0,e);const n=t.getBoundingClientRect();let i;t instanceof window.HTMLCanvasElement?i=t:(i=window.document.createElement("canvas"),t.appendChild(i),i.style.display="block",i.style.position="absolute",i.width=t.scrollWidth,i.height=t.scrollHeight),this.ctx=i.getContext("2d"),this.cursorPosition=new y,this.containerPosition=new y(n.left+window.scrollX,n.top+window.scrollY),this.isScene=!0,this.isLooped=!1,this.fps=0,this.lastTick=null,this[R](t)}setCursor(t=S.cursors.default){return this.ctx.canvas.style.cursor=t,this}render(t=this.ctx){const e=this.isLooped?window.requestAnimationFrame(this.render.bind(this,void 0)):null,n=t&&t.ctx||t;this.clear(n);try{super.render(n)}catch(t){throw window.cancelAnimationFrame(e),this.stopLoop(),t}const i=window.performance.now();return this.isLooped&&this.lastTick&&(this.fps=1e3/(i-this.lastTick)),this.lastTick=i,this}isHover(){return this.options.shown}clear(t=this.ctx){return t.clearRect(0,0,t.canvas.width,t.canvas.height),this.options.fill&&(t.fillStyle=this.options.fill.toString(t),t.fillRect(0,0,t.canvas.width,t.canvas.height)),this}startLoop(){return this.isLooped=!0,this.render(),this}stopLoop(){return this.isLooped=!1,this.fps=0,this}hide(){return this.ctx.canvas.style.visibility="hidden",super.hide()}show(){return this.ctx.canvas.style.visibility="",super.show()}get width(){return this.ctx.canvas.width}get height(){return this.ctx.canvas.height}get size(){return new y(this.width,this.height)}get center(){return this.size.divide(2)}getRandomPosition(){return new y(h(this.width),h(this.height))}static from(t){return new E(void 0,t.options)}static get defaultOptions(){return{...super.defaultOptions,fill:null,opacity:1,cursor:S.cursors.default}}}E.prototype[R]=function(t){if(this.isReady)throw new EvalError("Can't rebind event a second time.");let e=null,n=null;const i={[z.events.down]:(t,e)=>{t.isClicked=!0,n=e},[z.events.move]:(t,i)=>{n&&(t.isClicked=i.distance(n)<10),t!==e&&(e&&(e.isHovered=!1,e.isAncestorOf(t)||e.fire(new z(z.events.leave,e,i))),e=t),t.isHovered||(t.isHovered=!0,t.fire(new z(z.events.hover,t,i))),this.setCursor(t.options.cursor),this.cursorPosition.set(i)},[z.events.up]:(t,e)=>{n=null,t.isClicked&&t.fire(new z(z.events.click,t,e)),t.isClicked=!1},[z.events.wheel]:(t,e,n)=>{const i=z.events,s=n.deltaY>0?[i.scrollDown,i.zoomOut]:[i.scrollUp,i.zoomIn];t.fire(new z(s[0],t,e)).fire(new z(s[1],t,e))},mouseout:(t,e)=>{t.fire(new z(z.events.leave,t,e))}};Object.keys(i).forEach(e=>{t.addEventListener(e,t=>{if(this.options.shown){const n=new y(t.clientX,t.clientY).subtract(this.containerPosition).add(window.scrollX,window.scrollY),s=this.getTarget(n,this.ctx);s&&(s.fire(new z(e,s,n)),i[e]instanceof Function&&i[e](s,n,t))}},{passive:!0})});const s={[M.events.down]:null,[M.events.up]:null};Object.keys(s).forEach(e=>{t.addEventListener(e,t=>{this.options.shown&&(this.fire(new M(e,this,t.key)),s[e]instanceof Function&&s[e](t))})})};class P extends S{constructor(t,e=[],n){if(e.length<2)throw new RangeError(`A polygon can't have less than 3 vertices, but only ${e.length} given.`);super(t,n),this.points=e.map(t=>y.from(t))}trace(t){return this.points.concat([new y]).concat(...this.points.slice(0,2)).forEach(e=>t.lineTo(e.x,e.y)),this}toJSON(){const{points:t}=this;return{...super.toJSON(),points:t}}static from(t){return new P(t.position,t.points,t.options)}}class A extends P{constructor(t,e,n=0,i){super(t,A.getRotatingPoints(e,n),i),this.radius=n}trace(t){return this.points.concat(...this.points.slice(0,2)).forEach(e=>t.lineTo(e.x,e.y)),this}toJSON(){const{points:t,radius:e}=this,n={...super.toJSON(),nbSides:t.length,radius:e};return delete n.points,n}static from(t){return new A(t.position,t.nbSides,t.radius,t.options)}static getRotatingPoints(t,e,n=0){const i=n-.25,s=[];for(let n=0;n<t;++n){const r=(n/t+i)*Math.PI*2;s.push(new y(Math.cos(r)*e,Math.sin(r)*e))}return s}}class T extends S{constructor(t,e=0,n=0,i){super(t,i),this.width=e,this.height=n}trace(t){return t.rect(0,0,this.width,this.height),this}getOrigin(){const{origin:t}=this.options;if("string"==typeof t){const{origins:e}=T,n=new y;return t===e.center?n.set(-this.width/2,-this.height/2):n.set([e.topRight,e.bottomRight].includes(t)&&-this.width||0,[e.bottomLeft,e.bottomRight].includes(t)&&-this.height||0),n}return super.getOrigin()}toJSON(){const{width:t,height:e}=this;return{...super.toJSON(),width:t,height:e}}static from(t){return new T(t.position,t.width,t.height,t.options)}static get origins(){return{topLeft:"topLeft",topRight:"topRight",center:"center",bottomLeft:"bottomLeft",bottomRight:"bottomRight"}}}class C extends r{static get events(){return{ready:"ready",error:"error"}}}var I=function(t){return document.defaultView.getComputedStyle(t||document.body).direction},j=n(3),H=n.n(j),N=n(4);const L=(()=>{const t={};return(e,n)=>{const i=H()(`${e}${JSON.stringify(n)}`);if(void 0!==t[i])return t[i];const s={multiline:!0},r=N.init({fontFamily:n.font,fontSize:`${n.fontSize}px`,fontWeight:n.bold?"700":"400",lineHeight:`${n.fontSize*n.lineHeight}px`}),o={width:r.width(e,s),height:r.height(e,s)};return t[i]=o,o}})();class J extends S{constructor(t,e="",n){super(t,n),this.lines=[],this.text=e;const i=new C(C.events.ready,this);/^(\w+:)?\/\//.test(this.options.font)?J.load(this.options.font).then(t=>{this.options.font=t,this.fire(i)}):this.fire(i)}get text(){return this.lines.join("\n")}set text(t){var e;this.lines=(e=t,Array.isArray(e)?e.reduce((t,e)=>t.concat(e.split("\n")),[]):e.split("\n"))}makePath(t){const e=this.options;if(this.text.length&&(e.fill||e.stroke&&e.strokeWidth>0)){t.save();const n=J.measure("M",this.options).height,i=n/e.lineHeight,s=i*((e.lineHeight-1)/2);this.setContext(t),e.underscore&&t.beginPath();const r=-this.getAlignOffset();this.lines.forEach((o,a)=>{const h=a*n+s;if(e.fill&&t.fillText(o,r*this.width,h),e.stroke&&t.strokeText(o,r*this.width,h),e.underscore){const{width:n}=J.measure(o,e),s=r*(this.width-n);t.moveTo(s,h+i),t.lineTo(s+n,h+i)}}),e.underscore&&(t.lineWidth=i*(e.bold?.07:.05),t.strokeStyle=e.fill||e.stroke,t.stroke(),t.closePath()),t.restore()}return this}setContext(t){const[e,n]=super.setContext(t);return(e||n)&&(t.font=J.getFontDefinition(this.options),t.textAlign=this.options.align,t.textBaseline="top"),[e,n]}trace(t){return t.rect(0,0,this.width,this.height),t}getAlignOffset(){const{align:t}=this.options;let e=0;if(t===J.alignments.center)e=.5;else if(t===J.alignments.right)e=1;else if(t===J.alignments.start||t===J.alignments.end){const n=this.getRoot();if(n.isScene){const i=I(n.ctx.canvas);(t===J.alignments.start&&"rtl"===i||t===J.alignments.end&&"ltr"===i)&&(e=1)}}return-e}getOrigin(){return super.getOrigin().clone().add(this.getAlignOffset()*this.width,0)}getMeasures(){return J.measure(this.text,this.options)}get width(){return this.getMeasures().width}get height(){return this.getMeasures().height}toJSON(){const{text:t}=this;return{...super.toJSON(),text:t}}static from(t){return new J(t.position,t.text,t.options)}static load(t){if(Array.isArray(t))return Promise.all(t.map(t=>J.load(t)));const e=t.replace(/\W/g,"-"),n=new window.FontFace(e,`url(${t})`);return window.document.fonts.add(n),n.load().then(()=>e)}static getFontDefinition(t){return`${t.bold?"bold ":""}${t.italic?"italic ":""}${t.fontSize}px ${t.font}`}static measure(t,e){const n=Array.isArray(t)?t.join("\n"):t,i={...this.defaultOptions,...e};return L(n,i)}static get defaultOptions(){return{...super.defaultOptions,font:"sans-serif",fontSize:20,align:J.alignments.start,bold:!1,italic:!1,underscore:!1,lineHeight:1}}static get alignments(){return{left:"left",right:"right",center:"center",start:"start",end:"end"}}}class D extends S{constructor(t,e,n){super(t,n);const i=e.slice(0,2).every(t=>void 0===t||"number"==typeof t)?[y.from(e)]:e.map(t=>y.from(t));this.points=i}trace(t){return t.moveTo(0,0),this.points.forEach(e=>t.lineTo(e.x,e.y)),this}isHover(){return!1}toJSON(){const{points:t}=this;return{...super.toJSON(),points:t}}static from(t){return new D(t.position,t.points,t.options)}static get defaultOptions(){const t={...super.defaultOptions,cap:D.caps.round,join:D.joins.round,fill:null,cursor:null};return t.stroke=super.defaultOptions.fill,t}static get caps(){return{butt:"butt",round:"round",square:"square"}}}class B extends S{constructor(t,e=0,n=0,i=0,s=.5,r){super(t,r),this.horizontalRadius=e,this.verticalRadius=n,this.startAngle=i,this.endAngle=s}trace(t){const e=(this.startAngle+-.25)*c,n=(this.endAngle+-.25)*c;return t.ellipse(0,0,this.horizontalRadius,this.verticalRadius,0,e,n),this}toJSON(){const{horizontalRadius:t,verticalRadius:e,startAngle:n,endAngle:i}=this;return{...super.toJSON(),horizontalRadius:t,verticalRadius:e,startAngle:n,endAngle:i}}static from(t){return new B(t.position,t.horizontalRadius,t.verticalRadius,t.startAngle,t.endAngle,t.options)}static get defaultOptions(){return{...D.defaultOptions,join:null}}static get caps(){return D.caps}}class q extends B{constructor(t,e,n,i){super(t,e,n,0,1,i)}toJSON(){const t=super.toJSON();return delete t.startAngle,delete t.endAngle,t}static from(t){return new q(t.position,t.horizontalRadius,t.verticalRadius,t.options)}static get defaultOptions(){return S.defaultOptions}}class F extends q{constructor(t,e,n){super(t,e,e,n)}get radius(){return this.horizontalRadius}set radius(t){this.horizontalRadius=t,this.verticalRadius=t}trace(t){return t.arc(0,0,this.radius,0,c),this}toJSON(){const{radius:t}=this,e={...super.toJSON(),radius:t};return delete e.horizontalRadius,delete e.verticalRadius,e}static from(t){return new F(t.position,t.radius,t.options)}}class $ extends D{constructor(t,e,n=$.defaultTension,i){super(t,e,i),this.tension=n}trace(t){return 1===this.points.length||a(this.tension,0)?super.trace(t):(t.moveTo(0,0),$.splineThrough(t,[new y(0,0)].concat(this.points),this.tension)),this}toJSON(){const{tension:t}=this;return{...super.toJSON(),tension:t}}static from(t){return new $(t.position,t.points,t.tension,t.options)}static get defaultTension(){return.2}static splineThrough(t,e,n=$.defaultTension){if(e.length<2)throw new RangeError(`Need at least 2 points to spline, but only ${e.length} given.`);const i=e.map(t=>y.from(t));if(2===i.length)return void t.lineTo(i[1].x,i[1].y);const s=$.getControlPoint;let r=[null,i[0]];for(let e=1,o=i.length;e<o;++e){const a=e<o-1?s(i.slice(e-1,e+2),n):[i[e],null];t.bezierCurveTo(r[1].x,r[1].y,a[0].x,a[0].y,i[e].x,i[e].y),r=a}}static getControlPoint(t,e=$.defaultTension){if(t.length<3)throw new RangeError(`Need exactly 3 points to compute control points, but ${t.length} given.`);const n=t.map(t=>y.from(t)),i=n[2].clone().subtract(n[0]).multiply(e);return[n[1].clone().subtract(i),n[1].clone().add(i)]}}class G extends ${constructor(t,e){super(t.position,[],.2,{stroke:"#333",zIndex:-10}),this.from=t,this.to=e,this.middle=this.getCenter()}getCenter(){return this.position.clone().lerp(this.to.position,.5)}trace(...t){const e=this.getCenter();this.middle.lerp(e,.1),this.points=[this.middle,this.to.position].map(t=>t.clone().subtract(this.position)),this.children.forEach(t=>{t.position.lerp(t.options.destination,.08),t.position.distance(t.options.destination)<t.radius&&t.delete()}),super.trace(...t)}getOther(t){return t===this.from?this.to:t===this.to?this.from:null}sendFrom(t){const e=this.getOther(t);e.value+=1;const n=new F(t.position.clone().subtract(this.position),10,{fill:"#99ff66",stroke:"#333",zIndex:-5,destination:e.position.clone().subtract(this.position)});this.add(n)}}const V="#333",W=Symbol("_value");class U extends F{constructor(t,e,n=0){super(t,e,{stroke:V});const i=e/2,s=new F([0,4-i],i,{fill:"#fff",stroke:V,cursor:"pointer"});this.text=new J([0,-i/2],"0",{align:J.alignments.center,fill:V,fontSize:i,cursor:"pointer"}),s.add(this.text),this.add(s),this.links=[],this[W]=null,this.value=n,this.on("click",()=>this.click()),this.draggable()}click(){this.value-=this.links.length,this.links.forEach(t=>t.sendFrom(this)),this.fire(new r("lends",this))}delete(){this.links.forEach(t=>t.delete()),super.delete()}get value(){return this[W]}set value(t){this[W]=Math.round(t),this.text.text=this[W].toString(),this[W]<0?this.options.fill="#ff7365":this.options.fill="#99ff66"}linkTo(t){if(t&&!this.links.find(e=>e.getOther(this)===t)){const e=new G(this,t);return this.links.push(e),t.links.push(e),e}return null}toJSON(){const{position:t,links:e,value:n}=this;return{position:t,links:e,value:n}}}function _(t,e=[],n=0){return{position:y.from(t),links:e,value:n}}const Y=localStorage,X=btoa,K=atob;const Z=t=>{const e=X(function(t){return Math.random().toString(36).slice(-t)}(7)+X(JSON.stringify(t)));Y.setItem("socsim",e)};n(1);class Q extends T{constructor(t,e,n){super(t,e,e,n)}set size(t){this.width=t,this.height=t}get size(){return this.width}toJSON(){const{size:t}=this,e={...super.toJSON(),size:t};return delete e.height,delete e.width,e}static from(t){return new Q(t.position,t.size,t.options)}}Symbol("_url");class tt extends O{constructor(t,e){super(t,e),this.background=new T([0,0],0,0,{fill:this.options.background,stroke:this.options.border,strokeWidth:2,cursor:S.cursors.pointer}),this.add(this.background),this.background.on(z.events.hover,()=>{this.background.options.fill=this.options.hover}).on(z.events.leave,()=>{this.background.options.fill=this.options.background}).on(z.events.click,t=>{this.click(t.position.clone().subtract(this.getAbsolutePosition()))}),this.on(O.events.attach,()=>this.value=this.options.value,!0)}get value(){throw new ReferenceError(`Unimplemented get value function in ${this.constructor.name}`)}set value(t){throw new ReferenceError(`Unimplemented set value function in ${this.constructor.name}`)}click(){this.fire(new r(tt.events.change,this))}isHover(t,e){return this.options.shown&&this.background.isHover(this.position.clone().add(t),e)}toJSON(){const t=super.toJSON();return t.options=t.options||{},t.options.value=this.value,t.children=t.children.slice(1),t}static from(t){return new this(t.position,t.options)}static get defaultOptions(){return{...super.defaultOptions,value:null,fill:"#444",background:"#f6f6f6",border:"#aaa",hover:"#dcdcdc"}}static get events(){return{...super.events,change:"change"}}}S.prototype.draggable=function(t){const e=this.options.cursor===S.cursors.default;e&&(this.options.cursor=S.cursors.grab),this.isDraggable=!0;const n={x:!0,y:!0,...t};let i=null,s=null;return this.on(z.events.down,t=>{e&&(this.options.cursor=S.cursors.grabbing),i=t.position,s=this.position.clone(),this.isDragged=!0,this.fire(new z(z.events.grab,this,this.position))},!0),this.getScene().then(t=>t.on(z.events.move,t=>{if(this.isDragged&&i){const e=t.position.clone().subtract(i),r=s.clone().add(n.x&&e.x,n.y&&e.y);this.position.set(r),n.constrain&&this.position.constrain(n.constrain.start,n.constrain.end),this.fire(new z(z.events.drag,this,this.position))}}).on(z.events.up,()=>{e&&(this.options.cursor=S.cursors.grab),this.isDragged=!1,i=null,this.fire(new z(z.events.drop,this,this.position))})),{set x(t){n.x=t},set y(t){n.y=t},set constrain(t){n.constrain=t}}};const et=Symbol("_constrainer"),nt=Symbol("_moveHandle");class it extends tt{constructor(t,e){super(t,e),this.background.width=this.width,this.background.height=it.HEIGHT;const n=new O(new y(it.HEIGHT/2,it.HEIGHT/2));this.background.add(n),this.handle=new F(new y(0,0),(it.HEIGHT-2)/2,{fill:this.options.fill,cursor:S.cursors.ewResize}),n.add(this.handle),this[et]=new x(new y(0,0),new y(this.width-it.HEIGHT,0)),this.handle.draggable({constrain:this[et]}),this.handle.on(z.events.drag,()=>this.fire(new r(it.events.change,this)),!0)}click(t){this.handle.position.set(t.x-it.HEIGHT/2,0).constrain(this[et].start,this[et].end),super.click()}set width(t){if(t<it.HEIGHT)throw new RangeError(`Slider is too small, minimum is ${it.HEIGHT}px.`);this.options.width=t,this.background.width=t,this[et].end=new y(this.width-it.HEIGHT,0),this[nt](this.value)}get width(){return this.options.width}get value(){const t=this.options.max-this.options.min,e=this.handle.position.x/(this.width-it.HEIGHT);return this.options.min+t*e}set value(t){this[nt](o(t,this.options.min,this.options.max))}static get defaultOptions(){return{...super.defaultOptions,min:0,max:10,width:200}}static get HEIGHT(){return 20}}it.prototype[nt]=function(t){const e=this.options.max-this.options.min;this.handle.position.x=(this.width-it.HEIGHT)*((t-this.options.min)/e)};Symbol("_value");T.prototype.resizable=function(t){if(this.options.rotation%1!=0)throw new EvalError("Resizable don't support rotation.");const e=this.getOrigin();if(0!==e.x||0!==e.y)throw new EvalError("Resizable don't support other origin than [0, 0] or topLeft.");this.isResizable=!0;const n={x:!0,y:!0,handle:new P([this.width,this.height],[[-15,0],[0,-15]],{fill:"gold",cursor:S.cursors.seResize}),...t};if((!n.x||!n.y)&&this instanceof Q)throw new TypeError("Square should be resizable in both x and y axis.");this.add(n.handle);const i=n.handle.position.clone().multiply(-1).add(this.width,this.height),s=n.handle.draggable(n);return n.handle.on(z.events.drag,()=>{this instanceof Q?(n.handle.position.add(i),this.size=(n.handle.position.x+n.handle.position.y)/2,n.handle.position.set(this.size).subtract(i)):(n.x&&(this.width=n.handle.position.x+i.x),n.y&&(this.height=n.handle.position.y+i.y)),this.fire(new z(z.events.resize,this,n.handle.position))},!0),s};var st=n(0);st.c,st.a,st.b;class rt{constructor(){this.nodes=[]}isWon(){return!this.nodes.find(t=>t.value<0)}get(t){return this.nodes[t]}add(t){return this.nodes.push(t),this}magnetic(){const t=3*this.nodes[0].radius;this.nodes.forEach(e=>{if(!e.isDragged){const n=this.nodes.reduce((n,i)=>{const s=e.position.distance(i.position);return i!==e&&s<t&&n.add(e.position.clone().subtract(i.position).multiply((t-s)**2)),n},new y(0,0));e.position.add(n.divide(3e5))}})}toJSON(){const t=this.nodes.map(t=>t.toJSON());return t.forEach((t,e)=>{t.links=t.links.map(t=>this.nodes.indexOf(t.getOther(this.get(e))))}),t}static getNoduleRadius(t,e){return Math.min(...e)/(t**.5*2)}}function ot(t){return new y(i.random(-t[0],t[0]),i.random(-t[1],t[1]))}const at=new E(void 0,{fill:"#f5f5f5"}),ht=.1*Math.min(at.width,at.height),lt=[at.width/2-ht,at.height/2-ht],ct=Math.floor(at.width*at.height/12e4),ut=(()=>{const t=Y.getItem("socsim");if(!t)return{};const e=K(K(t).slice(7));return JSON.parse(e)})();let dt,pt=ut.mv||0,ft=ut.cl||0,gt=ut.df||0;const wt=new O(at.center);function mt(t){wt.empty(),dt=t?function(t,e){const n=rt.getNoduleRadius(t.length,e),i=new rt;for(let e=0,s=t.length;e<s;++e){const s=t[e],r=new U(s.position,n,s.value);s.links.filter(t=>t<e).map(t=>r.linkTo(i.nodes[t])),i.add(r)}return i}(t,lt):function(t,e,n){const s=rt.getNoduleRadius(e,t),r=new rt;let o=0;for(let n=0;n<e;++n){let e;const n=()=>r.nodes.find(t=>t.position.distance(e)<2*s);do{e=ot(t)}while(n());const a=new U(e,s);r.nodes.map((t,e)=>e).filter(t=>r.get(t).links.length<3).sort((t,n)=>r.get(t).position.distance(e)-r.get(n).position.distance(e)).slice(0,Math.round(i.random(1)+1)).forEach(t=>a.linkTo(r.get(t))),o+=a.links.length,r.add(a)}const a=Math.ceil(e**.5);let h=0;r.nodes.slice(1).forEach(t=>{const e=Math.round(i.random(2*a)-a);t.value=e,h+=e});const l=o-e+1,c=e/2*n;return r.get(0).value=l-h+c,r}(lt,Math.floor(ct+gt),1-gt%1);for(let t=0,e=dt.nodes.length;t<e;++t){const e=dt.get(t);wt.add(...e.links,e)}}at.add(wt);const yt=[[_([-100,0],[1],1),_([100,0],[0],-1)],[_([-300,0],[1],2),_([0,0],[0,2],-4),_([300,0],[1],2)],(()=>{let t=0;const e=A.getRotatingPoints(3,200);return[_(e[t++],[1,2],3),_(e[t++],[0,2],-2),_(e[2],[0,1],1)]})(),(()=>{const t=A.getRotatingPoints(5,200);return[_([0,0],[],30),...t.map(t=>_(t,[0],-5))]})(),(()=>{let t=0;const e=A.getRotatingPoints(8,200);return[_(e[t++],[],5),_(e[t++],[t-2],1),_(e[t++],[t-2],1),_(e[t++],[t-2],1),_(e[t++],[t-2],-2),_(e[t++],[t-2],1),_(e[t++],[t-2],1),_(e[t++],[t-2,0],1)]})()];mt(ut.gr||yt[ft]);const vt=new T([0,0],at.width,at.height,{fill:"#111",opacity:.5,zIndex:10}),bt=new J(at.center.subtract(0,70),"",{fill:"red",fontSize:70,align:"center",opacity:1,rotationAnchor:[0,35]});vt.add(bt);const xt=new J([10,10],`Level: ${ft}`,{fill:"#666"});function kt(t){Z({cl:ft,df:gt,gr:!t&&dt,mv:!t&&pt})}at.add(xt),vt.on("click",()=>{vt.delete(),pt=0,mt(yt[ft]),xt.text=`Level: ${ft}`,kt()}),at.on("lends",()=>{pt++,dt.isWon()?(at.add(vt),bt.text=`You won in ${pt} moves !`,yt[ft]||(gt+=.6),ft++,kt(!0)):kt()}).on("draw",()=>{vt.options.shown&&(bt.options.rotation=Math.cos(bt.frameCount/20)/50),dt.magnetic()},!0).startLoop()}]);